I"Ž<p>The SharePoint Online Management Shell is a Windows PowerShell module that can be installed on your Windows client or server. It is a set of commandlets that help you manage SharePoint Online users, sites, and site collections. Useful for the daily business and batch operations on multiple SharePoint Online sites. If you want to use it you need to have the following prerequisites:</p>

<ul>
  <li>Have the SharePoint Online or global administrator role on your tenant</li>
  <li>Install the SharePoint Online Management Shell module</li>
</ul>

<h4 id="how-do-i-install-the-sharepoint-online-management-shell-module">How do I install the SharePoint Online Management Shell module?</h4>
<p>You can download the latest package from <a href="https://www.powershellgallery.com/packages/Microsoft.Online.SharePoint.PowerShell">this website</a>.</p>

<p>If you have the latest PowerShell version installed, you can perform the installation procedure by using the <em>Install-Module</em> commandlet.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">Microsoft.Online.SharePoint.PowerShell</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>You can validate the installation by running the <em>Get-Module</em> command. It will return all installed SharePoint Online Management Module versions on your machine.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">Get-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">Microsoft.Online.SharePoint.PowerShell</span><span class="w"> </span><span class="nt">-ListAvailable</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Select</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="nx">Version</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="how-do-i-update-the-sharepoint-online-management-module">How do I update the SharePoint Online Management Module?</h4>
<p>The cloud is evolving, so their management modules. It is a good practice to update the PowerShell module to the latest version regularly on your machine. You can do this by using the Update-Module commandlet.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">Update-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">Microsoft.Online.SharePoint.PowerShell</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="how-do-i-uninstall-this-module">How do I uninstall this module?</h4>
<p>The module can be uninstalled by using the <em>Uninstall-Module</em> command. It will uninstall the latest version of the module on your machine.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">Uninstall-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">Microsoft.Online.SharePoint.PowerShell</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="how-do-i-connect-to-sharepoint-online">How do I connect to SharePoint Online?</h4>
<p>Before running any command against SharePoint Online site collections, you have to authenticate yourself using the <em>Connect-SPOService</em> command. If your account is secured with MFA (multi-factor authentication), the easiest way to connect is by using the sequence below.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nv">$tenant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"putYourTenantNameHere"</span><span class="w">
</span><span class="nv">$spoAdminUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://</span><span class="nv">$tenant</span><span class="s2">-admin.sharepoint.com"</span><span class="w">

</span><span class="nf">Connect-SPOService</span><span class="w"> </span><span class="nt">-Url</span><span class="w"> </span><span class="nv">$spoAdminUrl</span><span class="w">

</span><span class="c"># now execute your commands against SharePoint Online </span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>You can also use the variant below. Be aware, that it will not function for MFA secured accounts.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nv">$tenant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"putYourTenantNameHere"</span><span class="w">
</span><span class="nv">$spoAdminUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://</span><span class="nv">$tenant</span><span class="s2">-admin.sharepoint.com"</span><span class="w">
</span><span class="nv">$adminUPN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"putHereYourAdminUPN"</span><span class="w">

</span><span class="nv">$adminCredentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Get-Credential</span><span class="w"> </span><span class="nt">-UserName</span><span class="w"> </span><span class="nv">$adminUPN</span><span class="w">
</span><span class="nf">Connect-SPOService</span><span class="w"> </span><span class="nt">-Url</span><span class="w"> </span><span class="nv">$spoAdminUrl</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$adminCredentials</span><span class="w">

</span><span class="c"># now execute your commands against SharePoint Online </span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>
:ET